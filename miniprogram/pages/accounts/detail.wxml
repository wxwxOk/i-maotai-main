<!--pages/accounts/detail.wxml-->
<view class="container">
  <!-- 账号信息 -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">账号信息</text>
      <view class="status-tag {{account.isExpired ? 'expired' : 'normal'}}">
        {{account.isExpired ? 'Token已过期' : '正常'}}
      </view>
    </view>

    <view class="info-item">
      <text class="label">手机号</text>
      <text class="value">{{account.mobileMask}}</text>
    </view>

    <view class="info-item" wx:if="{{account.tokenExpireAt}}">
      <text class="label">Token有效期</text>
      <text class="value {{account.isExpired ? 'expired-text' : ''}}">{{account.tokenExpireAt}}</text>
    </view>
  </view>

  <!-- 位置信息 -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">位置信息</text>
      <text class="action-btn" bindtap="chooseLocation">{{account.provinceName ? '修改' : '设置'}}</text>
    </view>

    <view wx:if="{{account.provinceName}}">
      <view class="info-item">
        <text class="label">省市</text>
        <text class="value">{{account.provinceName}} {{account.cityName}}</text>
      </view>
      <view class="info-item" wx:if="{{account.address}}">
        <text class="label">详细地址</text>
        <text class="value">{{account.address}}</text>
      </view>
    </view>
    <view class="empty-tip" wx:else>
      <text>请设置位置信息，用于选择附近门店</text>
    </view>
  </view>

  <!-- 预约配置 -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">预约配置</text>
      <text class="action-btn" bindtap="goConfig">修改</text>
    </view>

    <view class="info-item">
      <text class="label">预约商品</text>
      <text class="value">{{config.itemNames || '未配置'}}</text>
    </view>
    <view class="info-item">
      <text class="label">门店类型</text>
      <text class="value">{{config.shopType === 1 ? '出货量最大' : '距离最近'}}</text>
    </view>
    <view class="info-item">
      <text class="label">预约时间</text>
      <text class="value">9:{{config.reserveMinute < 10 ? '0' + config.reserveMinute : config.reserveMinute}}</text>
    </view>
    <view class="info-item">
      <text class="label">自动旅行</text>
      <text class="value">{{config.autoTravel ? '已开启' : '已关闭'}}</text>
    </view>
    <view class="info-item">
      <text class="label">预约状态</text>
      <switch checked="{{config.isEnabled}}" bindchange="toggleEnabled" color="#c41230"/>
    </view>
  </view>

  <!-- 操作按钮 -->
  <view class="actions">
    <button class="btn primary" bindtap="manualReserve" loading="{{reserving}}">
      手动预约
    </button>
    <button class="btn" bindtap="relogin" wx:if="{{account.isExpired}}">
      重新登录
    </button>
    <button class="btn danger" bindtap="deleteAccount">
      删除账号
    </button>
  </view>
</view>
